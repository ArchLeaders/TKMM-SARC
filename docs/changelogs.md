# Chagelog Formats

> ### Important Note
> The files generated by the packager are not compatible with the game
> by default. You must merge all packaged files into a merged mods
> folder using the SarcTool or the associated library before you can boot the game.

## BYML Changelogs

The `byml`/`bgyml` files generated by the packager contain only the changes
to the particular file that differ from the vanilla version of the game. By 
default, the packager evaluates all released versions of the game and generates
changelogs for any element that differs from any of them.

### Hash Tables
For hash tables, the changelog includes added and modified elements. Any element
that exists in the changelog will cause an update of the existing element during a merge,
or the creation of a new element (if none exists).

If an element is deleted from vanilla, its key will be prefixed with `~DEL~`, indicating to the 
merger that the key should be deleted. For example:

```
{
  "~DEL~ModelProjectName": "PlayerAnimation"
}
```

This will instruct the merger to delete the `ModelProjectName` key from the hash
table entirely. Its value is ignored, but usually defaults to the vanilla value for
reference.

### Arrays
For arrays, the changelog can contain instructions to insert, modify, delete, or add to the
vanilla array.

An example of a changelog for an array looks like this:

```
AnimationResources:
- ~INDEX~: 0
  ~MOD~: {IsRetarget: true, ModelProjectName: GirlyAnim_Redirect}
- ~INDEX~: 1
  ~MOD~: {IsRetarget: true, ModelProjectName: Nml_Move_Walk_Hard}
- ~INDEX~: 2
  ~MOD~: {ModelProjectName: Player_Animation}
- ~ADD~: {ModelProjectName: Player_Demo_Animation}
- ~ADD~: {ModelProjectName: Player_Skin_Animation}
- ~ADD~: {ModelProjectName: GirlyAnim_Redirect}
- ~ADD~: {ModelProjectName: GirlyAnim}
- ~ADD~: {ModelProjectName: Nml_Move_Walk_Hard}
```

Each changelog entry contains either an `~ADD~`, `~MOD~`, `~DEL~` or `~INSERT~`
command key. The `~MOD~` and the `~DEL~` command keys further require an `~INDEX~` key, to let the
merger know which index (of the vanilla array) is being affected. The value of the
command key is the value of the element to be modified, added, or inserted,
as the case may be. For deletions, the value is ignored but usually defaults to the
vanilla value.

The `~INSERT~` command key is never automatically generated by the packager, but you
may manually edit the changelog to specify this option. `~INSERT~` will always insert
the specified value at the 0th index (first) in the target array. This is in contrast to
`~ADD~`, which will always add it at the end. This is useful in cases where you need to
insert custom values before vanilla values, without otherwise affecting the ordering. 

For example, the above changelog can be rewritten using `~INSERT~` like so, and achieve
a more compatible package:

```
AnimationResources:
- ~INSERT~: {IsRetarget: true, ModelProjectName: GirlyAnim_Redirect}
- ~INSERT~: {IsRetarget: true, ModelProjectName: Nml_Move_Walk_Hard}
- ~ADD~: {ModelProjectName: GirlyAnim_Redirect}
- ~ADD~: {ModelProjectName: GirlyAnim}
- ~ADD~: {ModelProjectName: Nml_Move_Walk_Hard}
```

**Mod authors should take care to ensure correct changelogs are generated to maximize the
compatibility of their mods in relation to other mods.** The packager is only able to 
make a best guess as to a mod author's intentions - it is not perfect and so all
of these changelogs should be reviewed and edited as needed.

## GameDataList Changelogs

The GameDataList (GDL) changelog is a binary file and therefore is not intended to be edited
by hand. You can look at the `GameDataListReader` and `GameDataListWriter` classes for 
implementation details.